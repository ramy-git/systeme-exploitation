INCLUDE = includes/
CC = gcc
DEBUG =
CPPFLAGS = -D_DEFAULT_SOURCE
CFLAGS = -Wall -Wextra -std=c99 -pedantic ${DEBUG} -I${INCLUDE}
LDFLAGS =
LDLIBS = -lpthread

SRC = src/main.c src/options.c

DEP = ${SRC:.c=.o}

# TARGET: /usr/local/bin (if user has write permissions) or ~/.local/bin
TARGET = $(shell if mkdir -p /usr/local/bin && test -w /usr/local/bin 2> /dev/null ; then\
		 			echo "/usr/local/bin"; \
					else \
						mkdir -p $$HOME/.local/bin && echo $$HOME/.local/bin; \
					fi)

carrefour: ${DEP}
	$(CC) -o $@ ${CFLAGS} ${DEP} ${LDLIBS}

.PHONY: doxygen
doxygen:
	doxygen Doxyfile

.PHONY: install
install: carrefour
	cp carrefour $(TARGET)/carrefour

.PHONY: clean
clean:
	$(RM) carrefour ${DEP}
	$(RM) -r html
